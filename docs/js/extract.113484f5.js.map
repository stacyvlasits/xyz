{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./js/extract/App.vue","webpack:///./js/extract/App.vue?7004","webpack:///./js/extract/FileLoaderControl.js","webpack:///./js/extract/SelectionControl.js","webpack:///./js/extract/XYZArray.js","webpack:///./js/extract/XYZObject.js","webpack:///./js/extract/View.js","webpack:///./js/extract/index.js","webpack:///./js/extract/App.vue?ef61"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","class","id","download","coordinate","onLVCoord","min","max","onBounds","props","components","CoordsForm","BoundsForm","methods","arg","this","bounds","lat","lon","ev","console","log","watch","$emit","deep","render","__scopeId","FileLoaderControl","fileLoaderElt","loadCb","addEventListener","onFileSelected","file","files","reader","FileReader","onload","content","arr","target","base64","toString","split","decoded","atob","readAsDataURL","SelectionControl","xyzObject","centerPointCoordinate","sourceBounds","viewBounds","onZoomChangeCb","minX","x","minY","y","maxX","maxY","width","height","Math","userSelection","button","isBoundsValid","gte","X","Y","Number","isFinite","Radius","parseFloat","Xmin","Ymin","Xmax","Ymax","activateDownloadButton","deactivateDownloadButton","gt","requestAnimationFrame","onclick","processBounds","fileContent","extractSectionAsXYZ","recenterToCenterPointCoordinate","Blob","type","url","URL","createObjectURL","href","setAttribute","removeAttribute","xyzData","lines","recenteredLines","line","trim","charAt","lineValues","isNaN","E","N","newLine","join","a","b","undefined","XYZArray","sourceArray","Error","src","numPoints","lastY","numX","numY","offset","curNumX","curNumY","toInsert","Float32Array","dst","y0","yCount","xi","yi","zi","geometry","usePoints","super","origArr","attributes","position","array","srcArr","computeBoundingBox","copy","boundingBox","shape","toPointsShape","toShape","add","Date","z","xMin","xMax","yMin","yMax","section","cutSection","xyzArr","coords","colors","sizes","geom","center","groundMaterial","color","sizeAttenuation","size","groundPoints","sortParticles","rotateX","PI","computeArrayShape","geom2","getAttribute","vertices","transferXYZ","computeFaceNormals","computeVertexNormals","obj","side","shininess","wireframe","receiveShadow","zoomBoxOpacity","container","document","querySelector","animCb","innerWidth","innerHeight","camera","set","radius","globe","flatShading","altitudeOffset","background","light","castShadow","intensity","shadow","near","far","shadowLight","clone","renderer","antialias","shadowMap","enabled","setSize","appendChild","domElement","controls","fs","onWindowResize","animate","view","zoomBox","xyzObj","remove","zoomBoundsIn","zoomBounds","children","sourceWidth","sourceDepth","viewWidth","viewDepth","viewXOff","viewYOff","zoomX","zoomY","zoomWidth","zoomDepth","ZOOM_EXTRA","zoomHeight","boxX","boxY","boxWidth","boxHeight","boxDepth","material","transparent","opacity","box","wireBox","update","isFullscreen","offsetWidth","offsetHeight","aspect","updateProjectionMatrix","sc","getElementById","comp","app","App","system","WGS84","min_lat","min_lon","max_lat","max_lon","lv95center","R","onCoordBounds","event","lv95min","lv95max","zoom","focus","coord","mount","display","displayXYZObject","centerPointCoordinates","setCoord","selectElt","trimmed","trimFileStart","XYZLoader","load","loadedXyz","parse","text","validLineRegex","indexOfFirstValidLine","search","substring","handleHash","location","hash","substr"],"mappings":"aACE,SAASA,EAAqBC,GAQ7B,IAPA,IAMIC,EAAUC,EANVC,EAAWH,EAAK,GAChBI,EAAcJ,EAAK,GACnBK,EAAiBL,EAAK,GAIHM,EAAI,EAAGC,EAAW,GACpCD,EAAIH,EAASK,OAAQF,IACzBJ,EAAUC,EAASG,GAChBG,OAAOC,UAAUC,eAAeC,KAAKC,EAAiBX,IAAYW,EAAgBX,IACpFK,EAASO,KAAKD,EAAgBX,GAAS,IAExCW,EAAgBX,GAAW,EAE5B,IAAID,KAAYG,EACZK,OAAOC,UAAUC,eAAeC,KAAKR,EAAaH,KACpDc,EAAQd,GAAYG,EAAYH,IAG/Be,GAAqBA,EAAoBhB,GAE5C,MAAMO,EAASC,OACdD,EAASU,OAATV,GAOD,OAHAW,EAAgBJ,KAAKK,MAAMD,EAAiBb,GAAkB,IAGvDe,IAER,SAASA,IAER,IADA,IAAIC,EACIf,EAAI,EAAGA,EAAIY,EAAgBV,OAAQF,IAAK,CAG/C,IAFA,IAAIgB,EAAiBJ,EAAgBZ,GACjCiB,GAAY,EACRC,EAAI,EAAGA,EAAIF,EAAed,OAAQgB,IAAK,CAC9C,IAAIC,EAAQH,EAAeE,GACG,IAA3BX,EAAgBY,KAAcF,GAAY,GAE3CA,IACFL,EAAgBQ,OAAOpB,IAAK,GAC5Be,EAASM,EAAoBA,EAAoBC,EAAIN,EAAe,KAItE,OAAOD,EAIR,IAAIQ,EAAmB,GAKnBhB,EAAkB,CACrB,QAAW,GAGRK,EAAkB,GAGtB,SAASS,EAAoB1B,GAG5B,GAAG4B,EAAiB5B,GACnB,OAAO4B,EAAiB5B,GAAU6B,QAGnC,IAAIC,EAASF,EAAiB5B,GAAY,CACzCK,EAAGL,EACH+B,GAAG,EACHF,QAAS,IAUV,OANAf,EAAQd,GAAUW,KAAKmB,EAAOD,QAASC,EAAQA,EAAOD,QAASH,GAG/DI,EAAOC,GAAI,EAGJD,EAAOD,QAKfH,EAAoBM,EAAIlB,EAGxBY,EAAoBO,EAAIL,EAGxBF,EAAoBQ,EAAI,SAASL,EAASM,EAAMC,GAC3CV,EAAoBW,EAAER,EAASM,IAClC3B,OAAO8B,eAAeT,EAASM,EAAM,CAAEI,YAAY,EAAMC,IAAKJ,KAKhEV,EAAoBe,EAAI,SAASZ,GACX,qBAAXa,QAA0BA,OAAOC,aAC1CnC,OAAO8B,eAAeT,EAASa,OAAOC,YAAa,CAAEC,MAAO,WAE7DpC,OAAO8B,eAAeT,EAAS,aAAc,CAAEe,OAAO,KAQvDlB,EAAoBmB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQlB,EAAoBkB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,kBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKxC,OAAOyC,OAAO,MAGvB,GAFAvB,EAAoBe,EAAEO,GACtBxC,OAAO8B,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOlB,EAAoBQ,EAAEc,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRtB,EAAoB0B,EAAI,SAAStB,GAChC,IAAIM,EAASN,GAAUA,EAAOiB,WAC7B,WAAwB,OAAOjB,EAAO,YACtC,WAA8B,OAAOA,GAEtC,OADAJ,EAAoBQ,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRV,EAAoBW,EAAI,SAASgB,EAAQC,GAAY,OAAO9C,OAAOC,UAAUC,eAAeC,KAAK0C,EAAQC,IAGzG5B,EAAoB6B,EAAI,QAExB,IAAIC,EAAaC,OAAO,gBAAkBA,OAAO,iBAAmB,GAChEC,EAAmBF,EAAW3C,KAAKsC,KAAKK,GAC5CA,EAAW3C,KAAOf,EAClB0D,EAAaA,EAAWG,QACxB,IAAI,IAAItD,EAAI,EAAGA,EAAImD,EAAWjD,OAAQF,IAAKP,EAAqB0D,EAAWnD,IAC3E,IAAIU,EAAsB2C,EAI1BzC,EAAgBJ,KAAK,CAAC,EAAE,gBAAgB,iBAEjCM,K,yOCtJJyC,MAAM,sB,EACT,eAAgE,KAA7DC,GAAG,QAAQD,MAAM,SAASE,SAAS,eAAc,YAAQ,G,EAC5D,eAAgC,UAA5B,2BAAuB,G,yIAF7B,eAKM,MALN,EAKM,CAJJ,EACA,EACA,eAA+E,GAAjEC,WAAY,EAAAA,WAAa,eAAe,EAAAC,W,wCACtD,eAA4E,GAA9DC,IAAK,EAAAA,IAAMC,IAAK,EAAAA,IAAM,gBAAgB,EAAAC,U,wEAQrC,GACbC,MAAO,CACLL,WAAYvD,OACZyD,IAAKzD,OACL0D,IAAK1D,QAEP6D,WAAY,CACVC,aAAA,KACAC,aAAA,MAEFC,QAAS,CACP,SAASC,GAEPC,KAAKC,OAASF,EACdC,KAAKT,IAAIW,IAAMH,EAAIR,IAAIW,IACvBF,KAAKT,IAAIY,IAAMJ,EAAIR,IAAIY,IACvBH,KAAKR,IAAIU,IAAMH,EAAIP,IAAIU,IACvBF,KAAKR,IAAIW,IAAMJ,EAAIP,IAAIW,KAEzB,UAAUC,GACRC,QAAQC,IAAI,8BAA+BF,GAC3C,MAAM7C,EAAIyC,KAAKX,YACd9B,EAAE2C,IAAK3C,EAAE4C,KAAO,CAACC,EAAGF,IAAKE,EAAGD,OAIjCI,MAAO,CACLlB,WAAY,CACV,UAEEW,KAAKQ,MAAM,sBACA,CAACnB,WAAYW,KAAKX,WAAYY,OAAQD,KAAKC,UAExDQ,MAAM,GAERlB,IAAK,CACH,UAEES,KAAKQ,MAAM,sBACA,CAACnB,WAAYW,KAAKX,WAAYE,IAAKS,KAAKT,IAAKC,IAAKQ,KAAKR,OAEpEiB,MAAM,GAERjB,IAAK,CACH,UAEEQ,KAAKQ,MAAM,sBACA,CAACnB,WAAYW,KAAKX,WAAYE,IAAKS,KAAKT,IAAKC,IAAKQ,KAAKR,OAEpEiB,MAAM,K,UCzDd,EAAOC,OAASA,EAChB,EAAOC,UAAY,kBAEJ,QCRA,MAAMC,EACnB,YAAYC,EAAeC,GACzBd,KAAKa,cAAgBA,EACrBb,KAAKa,cAAcE,iBAAiB,SAAU,KAC1Cf,KAAKgB,mBACJ,GACLhB,KAAKc,OAASA,EAGhB,iBACE,MAAMG,EAAOjB,KAAKa,cAAcK,MAAM,GAChCC,EAAS,IAAIC,WACnBD,EAAOE,OAASC,IACd,MAAMC,EAAMD,EAAQE,OAAO9E,OACrB+E,EAASF,EAAIG,WAAWC,MAAM,KAAK,GACnCC,EAAUC,KAAKJ,GACrBzB,KAAKc,OAAOc,IAEdT,EAAOW,cAAcb,ICfV,MAAMc,EACnB,YAAYC,EAAWC,EAAuBC,EAAcC,EAAYC,GACtEpC,KAAKgC,UAAYA,EACjBhC,KAAKiC,sBAAwBA,EAC7BjC,KAAKoC,eAAiBA,EACtB,MAAMC,EAAOH,EAAa3C,IAAI+C,EACxBC,EAAOL,EAAa3C,IAAIiD,EACxBC,EAAOP,EAAa1C,IAAI8C,EACxBI,EAAOR,EAAa1C,IAAIgD,EACxBG,EAAQF,EAAOJ,EACfO,EAASF,EAAOH,EACJM,KAAKrD,IAAImD,EAAOC,GAelC5C,KAAK8C,cAAgB,KAIvB,cAAc7C,EAAQ8C,GACpB,IACIC,GAAgB,EACpB,GAAI/C,EAAOjE,eAAe,UACxB,GAAIiH,EAAIhD,EAAOiD,IACRD,EAAIhD,EAAOkD,IACXC,OAAOC,SAASpD,EAAOqD,SACvBrD,EAAOqD,OAAS,EAAG,CACdC,WAAWtD,EAAOiD,GAClBK,WAAWtD,EAAOkD,GAD5B,MAEMpF,EAAIwF,WAAWtD,EAAOqD,QAC5BtD,KAAK8C,cAAgB,CACnBU,KAAMvD,EAAOiD,EAAInF,EACjB0F,KAAMxD,EAAOkD,EAAIpF,EACjB2F,KAAMzD,EAAOiD,EAAInF,EACjB4F,KAAM1D,EAAOkD,EAAIpF,GAEnBiC,KAAK4D,uBAAuBb,EAAQ9C,GACpC+C,GAAgB,OAEhBhD,KAAK6D,yBAAyBd,QAG5BE,EAAIhD,EAAOuD,OACRP,EAAIhD,EAAOwD,OACXK,EAAG7D,EAAOyD,KAAMzD,EAAOuD,OACvBM,EAAG7D,EAAO0D,KAAM1D,EAAOwD,OAC5BzD,KAAK8C,cAAgB7C,EACrBD,KAAK4D,uBAAuBb,EAAQ9C,GACpC+C,GAAgB,GAEhBhD,KAAK6D,yBAAyBd,GAG9BC,GACFe,sBAAsB,KACpB/D,KAAKoC,eAAepC,KAAK8C,iBAM/B,uBAAuBC,EAAQ9C,GAC7B8C,EAAOiB,QAAU,KACfhE,KAAKiE,cAAchE,EAAQ8C,GAC3B,IAAImB,EAAclE,KAAKgC,UAAUmC,oBAAoBnE,KAAK8C,eAE1DoB,EAAcE,EAAgCF,EAAalE,KAAKiC,uBAChE,MAAM5G,EAAO,IAAIgJ,KAAK,CAACH,GAAc,CAACI,KAAM,eACtCC,EAAMxF,OAAOyF,IAAIC,gBAAgBpJ,GACvC0H,EAAO2B,KAAOH,GAEhBxB,EAAO4B,aAAa,OAAQ,IAI9B,yBAAyB5B,GACvBA,EAAOiB,QAAU,KACjBjB,EAAO6B,gBAAgB,SAI3B,SAASR,EAAgCS,EAAS5C,GAChD,MAAM6C,EAAQD,EAAQlD,MAAM,MAEtBoD,EAAkB,GAExB1E,QAAQC,IAAI,wBAAyB2B,GAErC,IAAM,IAAI+C,KAAQF,EAEhB,GADAE,EAAOA,EAAKC,OACa,MAArBD,EAAKE,OAAQ,GAEfH,EAAgB5I,KAAK6I,OAChB,CAEL,IAAIG,EAAaH,EAAKrD,MAAO,OACzBW,EAAI6C,EAAW,GACf3C,EAAI2C,EAAW,GAEfC,MAAM9C,IAAM8C,MAAM5C,GACpBnC,QAAQC,IAAI,gCAAiCgC,EAAGE,IAEhD2C,EAAW,GAAK7C,EAAIL,EAAsBoD,EAC1CF,EAAW,GAAK3C,EAAIP,EAAsBqD,GAE5CjF,QAAQC,IAAI,uFAAwFgC,EAAGE,EAAG2C,EAAW,GAAIA,EAAW,GAAIlD,EAAsBoD,EAAGpD,EAAsBqD,GAEvL,MAAMC,EAAUJ,EAAWK,KAAK,KAEhCT,EAAgB5I,KAAKoJ,GAKzB,OAAOR,EAAgBS,KAAK,MAS9B,SAAS1B,EAAG2B,EAAGC,GAIb,YAHUC,IAAND,IACFA,EAAI,GAECtC,OAAOC,SAASoC,IAAMA,EAAIC,EAKnC,SAASzC,EAAIwC,EAAGC,GAId,YAHUC,IAAND,IACFA,EAAI,GAECtC,OAAOC,SAASoC,IAAMA,GAAKC,E,4BCtJrB,MAAME,EACnB,YAAYC,GACV,GAAIA,EAAYhK,OAAS,GAAKgK,EAAYhK,OAAS,GAAK,EACtD,MAAM,IAAIiK,MAAM,gEAAkED,EAAYhK,QAEhGmE,KAAK6F,YAAcA,EAIrB,oBACE,MAAME,EAAM/F,KAAK6F,YACXG,EAAYD,EAAIlK,OAAS,EAC/B,IAAIoK,EAAQF,EAAI,GACEG,EAAOF,EAAWG,EAAO,EAG3C,IAAK,IAAIxK,EAAI,EAAGA,EAAIoK,EAAIlK,OAAQF,GAAK,EAAG,CACtC,MAAM6G,EAAIuD,EAAIpK,EAAI,GAClB,GAAI6G,GAAKyD,EAAO,CACdC,EAAOvK,EAAI,EACXwK,EAAOH,EAAYE,EACnB,OAKF,MAAO,CAACA,EAAMC,GAyClB,WAAW5E,EAAK6E,EAAQF,EAAMC,EAAME,EAASC,GAC3C,MAAMC,EAAW,IAAIC,aAAa,GAClCjF,EAAIxE,OAAOqJ,EAAQ,KAAMG,GAI3B,YAAYE,GACV,MAAMV,EAAM/F,KAAK6F,YAIjB,IAAIa,EAAKX,EAAI,GACTY,EAAS,EACb,IAAK,IAAIhL,EAAI,EAAGA,EAAIoK,EAAIlK,QAAUF,EAAI8K,EAAI5K,OAAQF,GAAK,EAAG,CACxDgL,IACA,MAAMC,EAAKjL,EACLkL,EAAKlL,EAAI,EACTmL,EAAKnL,EAAI,EAET6G,GADIuD,EAAIa,GACJb,EAAIc,IACJd,EAAIe,GACVtE,GAAKkE,IAEPC,EAAS,EACTD,EAAKlE,GAEPiE,EAAIG,GAAMb,EAAIa,GACdH,EAAII,GAAMd,EAAIc,GACdJ,EAAIK,GAAMf,EAAIe,KC1FL,MAAM,UAAkB,OACrC,YAAYC,EAAUC,GAAY,GAIhC,GAHAC,QACAjH,KAAKkH,QAAU,IAAIH,EAASI,WAAWC,SAASC,OAChDrH,KAAKsH,OAAS,IAAI1B,EAAS5F,KAAKkH,SAC5B9B,MAAMpF,KAAKkH,QAAQ,IAErB,MADA7G,QAAQC,IAAIN,KAAKkH,QAASlH,KAAKsH,QACzB,IAAIxB,MAAM,8CAElB,MAAM5D,EAAe,IAAI,OACzB6E,EAASQ,qBACTrF,EAAasF,KAAKT,EAASU,aAEzBzH,KAAK0H,MADHV,EACWW,EAAc3H,KAAKsH,OAAOzB,YAAa3D,GAEvC0F,EAAQ5H,KAAKsH,OAAQpF,GAEpClC,KAAK6H,IAAI7H,KAAK0H,OAIhB,oBAAoBzK,GAClB,MAAMsE,EAAMvB,KAAKkH,QACXpC,EAAQ,CAAC,KAAK,IAAIgD,gCACxB,IAAK,IAAInM,EAAI,EAAGA,EAAI4F,EAAI1F,OAAQF,GAAK,EAAG,CACtC,MAAM2G,EAAIf,EAAI5F,GAAI6G,EAAIjB,EAAI5F,EAAI,GAAIoM,EAAIxG,EAAI5F,EAAI,GAE1C2G,EAAIrF,EAAEuG,MAAQhB,EAAIvF,EAAEwG,MAAQnB,EAAIrF,EAAEyG,MAAQlB,EAAIvF,EAAE0G,MAGpDmB,EAAM3I,KAAK,GAAGmG,KAAKE,KAAKuF,KAG1B,OADAjD,EAAM3I,KAAK,IACJ2I,EAAMU,KAAK,MAIpB,YAAYwC,EAAMC,EAAMC,EAAMC,GACR,MAAhBnI,KAAKoI,UACPpI,KAAKoI,QAAUpI,KAAKqI,WAAWL,EAAMC,EAAMC,EAAMC,IAEnDnI,KAAK6H,IAAI7H,KAAKoI,UAKlB,SAAST,EAAcW,EAAQpG,GAC7B,MAAM8D,EAAYsC,EAAOzM,OAAS,EAC5B0M,EAAS,IAAI/B,aAAa8B,EAAOzM,QACjC2M,EAAS,IAAIhC,aAAa8B,EAAOzM,QACjC4M,EAAQ,IAAIjC,aAAaR,GAC/B,IAAK,IAAIrK,EAAI,EAAGA,EAAI2M,EAAOzM,OAAQF,GAAK,EAAG,CACzC,MAAMiL,EAAKjL,EAAGkL,EAAKlL,EAAI,EAAGmL,EAAKnL,EAAI,EACnC4M,EAAO3B,GAAM0B,EAAO1B,GACpB2B,EAAO1B,GAAMyB,EAAOzB,GACpB0B,EAAOzB,GAAMwB,EAAOxB,GACpB0B,EAAO3B,GAAM,IACb4B,EAAM9M,EAAI,GAAK,EAEjB,MAAM+M,EAAO,IAAI,OACjBA,EAAK/D,aAAa,WAAY,IAAI,OAAsB4D,EAAQ,IAEhEG,EAAK/D,aAAa,OAAQ,IAAI,OAAsB8D,EAAO,IAC3DC,EAAKnB,qBACLmB,EAAKC,SACL,MAAMC,EAAiB,IAAI,OAAqB,CAC9CC,MAAO,MACPC,iBAAiB,EACjBC,KAAM,IAEFC,EAAe,IAAI,OAAaN,EAAME,GAK5C,OAJAI,EAAaC,eAAgB,EAC7BD,EAAa9G,aAAeA,EAC5B8G,EAAa7G,WAAauG,EAAKjB,YAC/BuB,EAAaE,QAAQrG,KAAKsG,IAAM,GACzBH,EAIT,SAASpB,EAAQU,EAAQpG,GACvB,MAAOgE,EAAMC,GAAQmC,EAAOc,oBAEtBC,EAAQ,IAAI,OAA0BnD,EAAMC,EAAMD,EAAO,EAAGC,EAAO,GACnEiB,EAAWiC,EAAMC,aAAa,YAC9BC,EAAWnC,EAASC,MAE1BiB,EAAOkB,YAAYD,GACnBF,EAAMV,SACNU,EAAM9B,qBACN8B,EAAMI,qBACNJ,EAAMK,uBACN,MAAMC,EAAM,IAAI,OAAWN,EAAO,IAAI,OAAwB,CAC5DR,MAAO,QAASe,KAAM,OAAkBC,UAAW,GAAIC,WAAW,KAMpE,OAJAH,EAAII,eAAgB,EACpBJ,EAAIzH,aAAeA,EACnByH,EAAIxH,WAAakH,EAAM5B,YACvBkC,EAAIT,QAAQrG,KAAKsG,IAAM,GAChBQ,EChGT,MAAMK,EAAiB,GAMR,MAAM,UAAa,OAChC,YAAYC,EAAYC,SAASC,cAAc,SAAUC,EAAS,MAEhE,GADAnD,SACKgD,EACH,MAAM,IAAInE,MAAM,4BAElB9F,KAAKiK,UAAYA,EACjBjK,KAAKoK,OAASA,EACdpK,KAAK2C,MAAQsH,EAAUI,WACvBrK,KAAK4C,OAASqH,EAAUK,YACxBtK,KAAKuK,OAAS,IAAI,OAAwB,GAAIvK,KAAK2C,MAAQ3C,KAAK4C,OAAQ,GAAK,MAC7E5C,KAAKuK,OAAOnD,SAASoD,IAAI,EAAG,GAAK,KACjCxK,KAAK6H,IAAI7H,KAAKuK,QACdvK,KAAK6H,IAAI,IAAI,QACb,MAAM4C,EAAS,OACTC,EAAQ,IAAI,OAChB,IAAI,OAAqBD,EAAQ,IAAK,IACtC,IAAI,OAAwB,CAC1BE,aAAa,EACbb,WAAW,EACXjB,MAAO,YAEL+B,EAAiB,GACvBF,EAAMtD,SAASoD,IAAI,GAAIC,EAASG,EAAgB,GAChDF,EAAMxB,QAAQrG,KAAKsG,GAAK,GACxBnJ,KAAK6H,IAAI6C,GACT1K,KAAK6K,WAAa,IAAI,OAAY,UAClC,MAAMC,EAAQ,IAAI,OAKlBA,EAAMC,YAAa,EACnBD,EAAME,UAAYhB,EAClBc,EAAMG,OAAOV,OAAOW,KAAO,GAC3BJ,EAAMG,OAAOV,OAAOY,IAAM,IAC1BL,EAAMG,OAAOV,OAAO5H,MAAQ,IAC5BmI,EAAMG,OAAOV,OAAO3H,OAAS,IAC7BkI,EAAM1D,SAASoD,KAAK,GAAK,KAAM,IAC/BxK,KAAK6H,IAAIiD,GACT9K,KAAK8K,MAAQA,EACb,MAAMM,EAAcN,EAAMO,QAC1BD,EAAYL,YAAa,EACzBK,EAAYJ,UAAY,EAAMhB,EAC9BhK,KAAK6H,IAAIuD,GACTpL,KAAKsL,SAAW,IAAI,OAAoB,CAACC,WAAW,IACpDvL,KAAKsL,SAASE,UAAUC,SAAU,EAGlCzL,KAAKsL,SAASI,QAAQ1L,KAAK2C,MAAO3C,KAAK4C,QACvCqH,EAAU0B,YAAY3L,KAAKsL,SAASM,YACpC5L,KAAK6L,SAAW,IAAI,OAAY7L,KAAKuK,OAAQvK,KAAKsL,SAASM,YAC3D5L,KAAK8L,GAAK,IAAI,OAAW7B,EAAW,KAChCjK,KAAK+L,mBAET/L,KAAK+L,iBACLhN,OAAOgC,iBAAiB,SAAU,KAC9Bf,KAAK+L,mBAET/L,KAAKgM,UACL9B,SAAS+B,KAAOjM,KAChBA,KAAKkM,QAAU,KAIjB,iBAAiBC,GACXnM,KAAKmM,QACPnM,KAAKoM,OAAOpM,KAAKmM,QAEnBnM,KAAK6H,IAAIsE,GACTnM,KAAKmM,OAASA,EACdnM,KAAK8K,MAAMtJ,OAAS2K,EAQtB,MAAME,GACJ,GAAoB,MAAhBA,EACF,MAAM,IAAIvG,MAAM,qBAElB,MAAMwG,EAAa,CACjB/M,IAAK,CAAE+C,EAAG+J,EAAa7I,KAAMhB,EAAG6J,EAAa5I,MAC7CjE,IAAK,CAAE8C,EAAG+J,EAAa3I,KAAMlB,EAAG6J,EAAa1I,OAGzCzB,EAAelC,KAAKmM,OAAOI,SAAS,GAAGrK,aACvCsK,EAActK,EAAa1C,IAAI8C,EAAIJ,EAAa3C,IAAI+C,EACpDmK,EAAcvK,EAAa1C,IAAIgD,EAAIN,EAAa3C,IAAIiD,EAEpDL,EAAanC,KAAKmM,OAAOI,SAAS,GAAGpK,WACrCuK,EAAYvK,EAAW3C,IAAI8C,EAAIH,EAAW5C,IAAI+C,EAC9CqK,EAAYxK,EAAW3C,IAAIgD,EAAIL,EAAW5C,IAAIiD,EAC9CoK,EAAWzK,EAAW5C,IAAI+C,EAC1BuK,EAAW1K,EAAW5C,IAAIiD,EAC1BsK,EAAQR,EAAW/M,IAAI+C,EACvByK,EAAQT,EAAW/M,IAAIiD,EACvBwK,EAAYV,EAAW9M,IAAI8C,EAAIgK,EAAW/M,IAAI+C,EAC9C2K,EAAYX,EAAW9M,IAAIgD,EAAI8J,EAAW/M,IAAIiD,EAC9C0K,EAAa,EACbC,EAAahL,EAAW3C,IAAIuI,EAAI5F,EAAW5C,IAAIwI,EAAImF,EACnDE,EAAON,EAAQ5K,EAAa3C,IAAI+C,EAEhC+K,EAAON,EAAQ7K,EAAa3C,IAAIiD,EAChC8K,EAAWN,EAAYR,EAAcE,EACrCa,EAAYJ,EACZK,EAAWP,EAAYR,EAAcE,EACrC5F,EAAW,IAAI,OAAkBuG,EAAUC,EAAWC,GAC5DzG,EAAS4B,SACT,MAAM8E,EAAW,IAAI,OAAwB,CACzC5E,MAAO,SAAU6E,aAAa,EAAMC,QAAS3D,IAC3C4D,EAAM,IAAI,OAAW7G,EAAU0G,GACrCG,EAAI7C,YAAa,EACjB6C,EAAI7D,eAAgB,EACpB,MAAM8D,EAAUD,EAAIvC,QACpBwC,EAAQ9C,YAAa,EACrB8C,EAAQ9D,eAAgB,EACxB8D,EAAQJ,SAAW,IAAI,OAAwB,CAC3C5E,MAAO,SAAU6E,aAAa,EAAMC,QAAS3D,EAAgBF,WAAW,IAC5E8D,EAAI/F,IAAIgG,GACJ7N,KAAKkM,SACPlM,KAAKoM,OAAOpM,KAAKkM,SAEnBlM,KAAK6H,IAAI7H,KAAKkM,QAAU0B,GAIxBA,EAAIxG,SAAS9E,EAAIsK,EAAWQ,EAAOE,EAAYA,EAAW,EAE1DM,EAAIxG,SAASW,GAAK8E,EAAWQ,EAAOG,EAAYA,EAAW,EAC3DI,EAAIxG,SAAS5E,GAAM0K,EAAa,EAQlC,UACElN,KAAK6L,SAASiC,SACd9N,KAAKsL,SAAS5K,OAAOV,KAAMA,KAAKuK,QAC5BvK,KAAKoK,QACPpK,KAAKoK,OAAOpK,MAEd+D,sBAAsB,KAClB/D,KAAKgM,YAKX,iBACMhM,KAAK8L,GAAGiC,gBACV/N,KAAK2C,MAAQ5D,OAAOsL,WACpBrK,KAAK4C,OAAS7D,OAAOuL,cAErBtK,KAAK2C,MAAQ3C,KAAKiK,UAAU+D,YAC5BhO,KAAK4C,OAAS5C,KAAKiK,UAAUgE,cAE/BjO,KAAKuK,OAAO2D,OAASlO,KAAK2C,MAAQ3C,KAAK4C,OACvC5C,KAAKuK,OAAO4D,yBACZnO,KAAKsL,SAASI,QAAQ1L,KAAK2C,MAAO3C,KAAK4C,S,0BCvJ3C,IAAIwL,EALJ,SACA,IAAI,OAAWlE,SAASmE,eAAe,SAEvChO,QAAQC,IAAI,+BAAgC,QAG5C,MAAM2L,EAAO,IAAI,EACjB,IAAIqC,EACJ,MAAMC,EAAM,OAAc,CACxB5O,WAAY,CACV,eAAgB6O,GAElB,OACE,MAAMhR,EAAI,CACR6B,WAAY,CACVa,IAAK,OAAUA,IACfC,IAAK,OAAUA,IACfsO,OAAQ,OAAOC,MACfpJ,EAAG,EACHD,EAAG,GAEL9F,IAAK,CACHW,IAAK,OAAUyO,QACfxO,IAAK,OAAUyO,QACfH,OAAQ,OAAOC,OAEjBlP,IAAK,CACHU,IAAK,OAAU2O,QACf1O,IAAK,OAAU2O,QACfL,OAAQ,OAAOC,QAInB,OAAOlR,GAET,UAEE8Q,EAAOtO,KACPjB,OAAOuP,KAAOA,EAGd,MAAMS,EAAa,eAAS,OAAU7O,IAAK,OAAUC,KACrDH,KAAKX,WAAWiG,EAAIyJ,EAAW,GAC/B/O,KAAKX,WAAWgG,EAAI0J,EAAW,IAEjCjP,QAAS,CACP,SAASwF,EAAGD,EAAG2J,GAOb3O,QAAQC,IAAI,gBAAiBN,KAAKX,WAAYW,KAAKT,IAAKS,KAAKR,KAC7DQ,KAAKiP,cAAc,CAAC5P,WAAYW,KAAKX,WAAYE,IAAKS,KAAKT,IAAKC,IAAKQ,KAAKR,OAE5E,cAAc0P,GACZ,MAAM3P,EAAM2P,EAAM3P,IAAKC,EAAM0P,EAAM1P,IAC7B2P,EAAU,eAAS5P,EAAIW,IAAKX,EAAIY,KAChCiP,EAAU,eAAS5P,EAAIU,IAAKV,EAAIW,KAEhCkP,EAAO,CACX7L,KAAM2L,EAAQ,GACdzL,KAAM0L,EAAQ,GACd3L,KAAM0L,EAAQ,GACdxL,KAAMyL,EAAQ,IAGhBnD,EAAKqD,MAAMD,GACXjB,EAAGnK,cAAcoL,EAAMnF,SAASmE,eAAe,YAGnD9N,MAAO,CACLgP,MAAO,CACL,UACElP,QAAQC,IAAI,iCAAkCN,KAAKX,aAErDoB,MAAM,MAIZ8N,EAAIiB,MAAM,QAGV,MAAMC,EAAU1I,IACd,MAAM4C,EAAM,IAAI,EAAU5C,GAC1BkF,EAAKyD,iBAAiB/F,GACtB,MAAM1J,EAAS0J,EAAIjC,MAAMxF,aACzB,GAAIoM,EAAM,CACR,MAAMqB,EAAyBrB,EAAKjP,WACpC+O,EAAK,IAAIrM,EAAiB4H,EAAKgG,EAAwBhG,EAAIjC,MAAMxF,aAAcyH,EAAIjC,MAAMvF,WAAYkN,OAIrG,MAAM/J,EAAIrF,EAAOV,IAAIiD,GAAKvC,EAAOT,IAAIgD,EAAIvC,EAAOV,IAAIiD,GAAK,EACnD6C,EAAIpF,EAAOV,IAAI+C,GAAKrC,EAAOT,IAAI8C,EAAIrC,EAAOV,IAAI+C,GAAK,EAEzDgM,EAAKsB,SAAStK,EAAGD,EAAG,KAOlBwK,EAAY3F,SAASC,cAAc,0BACzC0F,EAAU9O,iBAAiB,SAAU,KACnC,MAAM+O,EAAUC,EAAcF,EAAU3R,QACxC,IAAI8R,EAAA,MAAYC,KAAKH,EAASL,KAEhC,MAAM,EAAUM,EAAcF,EAAU3R,QACxC,IAAI8R,EAAA,MAAYC,KAAK,EAASR,GAE9B,MAAM5O,EAAgBqJ,SAASmE,eAAe,cAC7B,IAAIzN,EAAkBC,EAAeqP,IAClD,MAAMJ,EAAUC,EAAcG,GAC9BT,GAAQ,IAAIO,EAAA,MAAYG,MAAML,MAGlC,SAASC,EAAcK,GAErB,MAAMC,EAAiB,6CACjBC,EAAwBF,EAAKG,OAAOF,GACpCP,EAAUM,EAAKI,UAAUF,GAE/B,OADAjQ,QAAQC,IAAI,UAAUwP,GACfA,EAGT,SAASW,IACIC,SAASC,KAAKC,OAAO,GAElC7R,OAAOgC,iBAAiB,aAAc0P,GACtCA,K,kCCtJA,W","file":"js/extract.113484f5.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"extract\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/xyz/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([2,\"chunk-vendors\",\"chunk-common\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","<template>\n<div class=\"coords-bounds-form\">\n  <a id=\"dlbtn\" class=\"button\" download=\"extract.xyz\">Download</a>\n  <h3>Center Point Coordinate</h3>\n  <coords-form :coordinate=\"coordinate\" @coord-changed=\"onLVCoord\"></coords-form>\n  <bounds-form :min=\"min\" :max=\"max\" @bounds-changed=\"onBounds\"></bounds-form>\n</div>\n</template>\n<script>\n  import CoordsForm from '../coords/CoordsForm.vue';\n  import BoundsForm from '../bounds/BoundsForm.vue';\n\n\n  export default {\n    props: {\n      coordinate: Object,\n      min: Object,\n      max: Object\n    },\n    components: {\n      CoordsForm,\n      BoundsForm\n    },\n    methods: {\n      onBounds(arg) {\n        //console.log('extract/App.vue#onBounds: ', arg.min.lat, arg.min.lon, arg.max.lat, arg.max.lon);\n        this.bounds = arg;\n        this.min.lat = arg.min.lat;\n        this.min.lon = arg.min.lon;\n        this.max.lat = arg.max.lat;\n        this.max.lon = arg.max.lon;\n      },\n      onLVCoord(ev) {\n        console.log('extract/App.vue#onLVCoord: ', ev);\n        const c = this.coordinate;\n        [c.lat, c.lon] = [ev.lat, ev.lon];\n        //console.log('App.vue#onLVCoord: ', c);\n      }\n    },\n    watch: {\n      coordinate: {\n        handler() {\n          //console.log('App.vue#watch.coordinate: emitting coord-bounds-change', this.coordinate, this.bounds);\n          this.$emit('coord-bounds-change',\n                     {coordinate: this.coordinate, bounds: this.bounds});\n        },\n        deep: true\n      },\n      min: {\n        handler() {\n          //console.log('App.vue#watch.min: emitting coord-bounds-change', this.coordinate, this.min, this.max);\n          this.$emit('coord-bounds-change',\n                     {coordinate: this.coordinate, min: this.min, max: this.max});\n        },\n        deep: true\n      },\n      max: {\n        handler() {\n          //console.log('App.vue#watch.bounds: emitting coord-bounds-change', this.coordinate, this.min, this.max);\n          this.$emit('coord-bounds-change',\n                     {coordinate: this.coordinate, min: this.min, max: this.max});\n        },\n        deep: true\n      }\n    }\n  }\n</script>\n<style scoped>\n.coords-bounds-form {\n  margin: 1em 0;\n}\n\n\n.coords-bounds-form input {\n  margin: 5px;\n  padding: 5px;\n}\n\n\n.button {\n  display: inline-block;\n  text-decoration: none;\n  background-color: #eee;\n  color: lightgrey;\n  margin-top: 5px;\n  padding: 5px;\n  border: 1px solid lightgrey;\n  border-bottom: 1px solid darkgrey;\n  border-right: 1px solid darkgrey;\n}\n\n\n.button[href] {\n  background-color: green;\n  color: white;\n}\n\n\nselect {\n    padding: 5px;\n}\n</style>\n","import { render } from \"./App.vue?vue&type=template&id=78e27a06&scoped=true\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\n\nimport \"./App.vue?vue&type=style&index=0&id=78e27a06&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-78e27a06\"\n\nexport default script","export default class FileLoaderControl {\n  constructor(fileLoaderElt, loadCb) {\n    this.fileLoaderElt = fileLoaderElt;\n    this.fileLoaderElt.addEventListener('change', () => {\n        this.onFileSelected();\n      }, false);\n    this.loadCb = loadCb;\n  }\n\n  onFileSelected() {\n    const file = this.fileLoaderElt.files[0];\n    const reader = new FileReader();\n    reader.onload = content => {\n      const arr = content.target.result;\n      const base64 = arr.toString().split(',')[1];\n      const decoded = atob(base64);\n      this.loadCb(decoded);\n    };\n    reader.readAsDataURL(file);\n  }\n}\n\n","/**\n * Setup the input sliders and text fields with min/max bounds.\n */\nexport default class SelectionControl {\n  constructor(xyzObject, centerPointCoordinate, sourceBounds, viewBounds, onZoomChangeCb) {\n    this.xyzObject = xyzObject;\n    this.centerPointCoordinate = centerPointCoordinate;\n    this.onZoomChangeCb = onZoomChangeCb;\n    const minX = sourceBounds.min.x;\n    const minY = sourceBounds.min.y;\n    const maxX = sourceBounds.max.x;\n    const maxY = sourceBounds.max.y;\n    const width = maxX - minX;\n    const height = maxY - minY;\n    const maxRadius = Math.max(width, height) / 2;\n    // These max values must be >0 and a number.\n    const radiusParams = {\n      X: [minX, maxX],\n      Y: [minY, maxY],\n      Radius: [0, maxRadius]\n    };\n\n    const boxParams = {\n      Xmin: [minX, maxX],\n      Ymin: [minY, maxY],\n      Xmax: [minX, maxX],\n      Ymax: [minY, maxY]\n    };\n\n    this.userSelection = null;\n  }\n\n\n  processBounds(bounds, button) {\n    let boxBounds = bounds;\n    let isBoundsValid = false;\n    if (bounds.hasOwnProperty('Radius')) {\n      if (gte(bounds.X)\n          && gte(bounds.Y)\n          && Number.isFinite(bounds.Radius)\n          && bounds.Radius > 0) {\n        const x = parseFloat(bounds.X);\n        const y = parseFloat(bounds.Y);\n        const r = parseFloat(bounds.Radius);\n        this.userSelection = {\n          Xmin: bounds.X - r,\n          Ymin: bounds.Y - r,\n          Xmax: bounds.X + r,\n          Ymax: bounds.Y + r\n        };\n        this.activateDownloadButton(button, bounds);\n        isBoundsValid = true;\n      } else {\n        this.deactivateDownloadButton(button);\n      }\n    } else {\n      if (gte(bounds.Xmin)\n          && gte(bounds.Ymin)\n          && gt(bounds.Xmax, bounds.Xmin)\n          && gt(bounds.Ymax, bounds.Ymin)) {\n        this.userSelection = bounds;\n        this.activateDownloadButton(button, bounds);\n        isBoundsValid = true;\n      } else {\n        this.deactivateDownloadButton(button);\n      }\n    }\n    if (isBoundsValid) {\n      requestAnimationFrame(() => {\n        this.onZoomChangeCb(this.userSelection);\n      });\n    }\n  }\n\n\n  activateDownloadButton(button, bounds) {\n    button.onclick = () => {\n      this.processBounds(bounds, button);\n      let fileContent = this.xyzObject.extractSectionAsXYZ(this.userSelection);\n\n      fileContent = recenterToCenterPointCoordinate(fileContent, this.centerPointCoordinate);\n      const data = new Blob([fileContent], {type: 'text/plain'});\n      const url = window.URL.createObjectURL(data);\n      button.href = url;\n    }\n    button.setAttribute('href', '');\n  }\n\n\n  deactivateDownloadButton(button) {\n    button.onclick = null;\n    button.removeAttribute('href');\n  }\n}\n\nfunction recenterToCenterPointCoordinate(xyzData, centerPointCoordinate){\n  const lines = xyzData.split('\\n');\n\n  const recenteredLines = [];\n  \n  console.log(\"centerPointCoordinate\", centerPointCoordinate);\n  \n  for ( let line of lines ) {\n    line = line.trim();\n    if (line.charAt( 0 ) === '#' ){\n      //retain comments\n      recenteredLines.push(line); \n    } else {\n    \n      let lineValues = line.split( /\\s+/ );\n      let x = lineValues[0];\n      let y = lineValues[1];\n\n      if (isNaN(x) || isNaN(y)) {\n        console.log(\"Unexpected data: not a number\", x, y);\n      } else {\n        lineValues[0] = x - centerPointCoordinate.E;\n        lineValues[1] = y - centerPointCoordinate.N;\n      }\n      console.log(\"x, y, lineValues[0], lineValues[1], centerPointCoordinate.E, centerPointCoordinate.N\", x, y, lineValues[0], lineValues[1], centerPointCoordinate.E, centerPointCoordinate.N);\n\n      const newLine = lineValues.join(' ');\n\n      recenteredLines.push(newLine);\n    }\n\n  }\n\n  return recenteredLines.join('\\n');\n}\n\nfunction clip(min, max, val) {\n  return Math.min(Math.max(val, min), max);\n}\n\n\n/** @return true Iff a is a finite number and a > b. */\nfunction gt(a, b) {\n  if (b === undefined) {\n    b = 0;\n  }\n  return Number.isFinite(a) && a > b;\n}\n\n\n/** @return true Iff a is a finite number and a > b. */\nfunction gte(a, b) {\n  if (b === undefined) {\n    b = 0;\n  }\n  return Number.isFinite(a) && a >= b;\n}\n","export default class XYZArray {\n  constructor(sourceArray) {\n    if (sourceArray.length < 3 || sourceArray.length % 3 != 0) {\n      throw new Error('Source array length must be mulitples of 3 and >= 3, but is: ' + sourceArray.length);\n    }\n    this.sourceArray = sourceArray;\n  }\n\n\n  computeArrayShape() {\n    const src = this.sourceArray;\n    const numPoints = src.length / 3;\n    let lastY = src[1]; // TODO: assumes data sorted by Y\n    let first = true, numX = numPoints, numY = 1;\n    // First, scan the array to see what the X dimension is from the\n    // first column.\n    for (let i = 3; i < src.length; i += 3) {\n      const y = src[i + 1];\n      if (y != lastY) {\n        numX = i / 3;\n        numY = numPoints / numX;\n        break;\n      }\n    }\n    //console.log(`after scan numX:${numX} numY:${numY}`);\n    if (true) {\n      return [numX, numY];\n    }\n    // Now, find bounding box.\n    let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;\n    for (let i = 0; i < src.length; i += 3) {\n      const x = src[i];\n      const y = src[i + 1];\n      minX = Math.min(minX, x);\n      minY = Math.min(minY, y);\n      maxX = Math.max(maxX, x);\n      maxY = Math.max(maxY, y);\n    }\n    if (minX == Infinity || minY == Infinity || maxX == -Infinity || maxY == -Infinity) {\n      throw new Error(`Unbounded data in array: minX:${minX} minY:${minY} maxX:${maxX} maxY:${maxY}`);\n    }\n    console.log(`bounds minX:${minX} minY:${minY} maxX:${maxX} maxY:${maxY}`);\n\n    for (let i = 3; i < src.length; i += 3) {\n      const y = src[i + 1];\n      if (y != lastY) {\n        if (first) {\n          first = false;\n          numX = i / 3;\n          numY = numPoints / numX;\n        } else {\n          const newNumX = i / 3;\n          const newNumY = numPoints / numX;\n          if (newNumX != numX)\n            console.log(`i:${i} newNumX:${newNumX} != numX:${numX}`);\n          if (newNumY != numY)\n            console.log(`$:${i} newNumY:${newNumY} != numX:${numY}`);\n          //this.fixupArray(src, numX, numY, newNumX, newNumY);\n          throw new Error('Sparse data');\n        }\n      }\n    }\n    console.log(`numX:${numX} numY:${numY}`);\n    return [numX, numY];\n  }\n\n\n  fixupArray(arr, offset, numX, numY, curNumX, curNumY) {\n    const toInsert = new Float32Array(3 * 1);\n    arr.splice(offset, 0, ...toInsert);\n  }\n\n\n  transferXYZ(dst) {\n    const src = this.sourceArray;\n    //if (dst.length != src.length) {\n    //  throw new Error('dst.length != src.length');\n    //}\n    let y0 = src[1];\n    let yCount = 0;\n    for (let i = 0; i < src.length && i < dst.length; i += 3) {\n      yCount++;\n      const xi = i;\n      const yi = i + 1;\n      const zi = i + 2;\n      const x = src[xi];\n      const y = src[yi];\n      const z = src[zi];\n      if (y != y0) {\n        //console.log('found new y at yCount:' + yCount);\n        yCount = 0;\n        y0 = y;\n      }\n      dst[xi] = src[xi];\n      dst[yi] = src[yi];\n      dst[zi] = src[zi];\n    }\n  }\n}\n","import * as THREE from 'three/build/three.module.js';\nimport XYZArray from './XYZArray.js';\n\n\n/** Scene object to view XYZ file. */\nexport default class XYZObject extends THREE.Object3D {\n  constructor(geometry, usePoints = true) {\n    super();\n    this.origArr = [...geometry.attributes.position.array];\n    this.srcArr = new XYZArray(this.origArr);\n    if (isNaN(this.origArr[0])) {\n      console.log(this.origArr, this.srcArr);\n      throw new Error('Bogus data in source geometry.. found NaNs');\n    }\n    const sourceBounds = new THREE.Box3;\n    geometry.computeBoundingBox();\n    sourceBounds.copy(geometry.boundingBox);\n    if (usePoints) {\n      this.shape = toPointsShape(this.srcArr.sourceArray, sourceBounds);\n    } else {\n      this.shape = toShape(this.srcArr, sourceBounds);\n    }\n    this.add(this.shape);\n  }\n\n\n  extractSectionAsXYZ(s) {\n    const arr = this.origArr;\n    const lines = [`# ${new Date()}, exported from XYZ tool`];\n    for (let i = 0; i < arr.length; i += 3) {\n      const x = arr[i], y = arr[i + 1], z = arr[i + 2];\n      //console.log(`evaling: ${x} ${y} ${z}`);\n      if (x < s.Xmin || y < s.Ymin || x > s.Xmax || y > s.Ymax) {\n        continue;\n      }\n      lines.push(`${x} ${y} ${z}`);\n    }\n    lines.push('');\n    return lines.join('\\n');\n  }\n\n\n  showSection(xMin, xMax, yMin, yMax) {\n    if (this.section == null) {\n      this.section = this.cutSection(xMin, xMax, yMin, yMax);\n    }\n    this.add(this.section);\n  }\n}\n\n\nfunction toPointsShape(xyzArr, sourceBounds) {\n  const numPoints = xyzArr.length / 3;\n  const coords = new Float32Array(xyzArr.length);\n  const colors = new Float32Array(xyzArr.length);\n  const sizes = new Float32Array(numPoints);\n  for (let i = 0; i < xyzArr.length; i += 3) {\n    const xi = i, yi = i + 1, zi = i + 2;\n    coords[xi] = xyzArr[xi];\n    coords[yi] = xyzArr[yi];\n    coords[zi] = xyzArr[zi];\n    colors[yi] = 0xff;\n    sizes[i / 3] = 1;\n  }\n  const geom = new THREE.BufferGeometry();\n  geom.setAttribute('position', new THREE.BufferAttribute(coords, 3));\n  //geom.setAttribute('color', new THREE.BufferAttribute(colors, 3));\n  geom.setAttribute('size', new THREE.BufferAttribute(sizes, 1));\n  geom.computeBoundingBox();\n  geom.center();\n  const groundMaterial = new THREE.PointsMaterial({\n    color: 0x008800,\n    sizeAttenuation: false,\n    size: 2\n  });\n  const groundPoints = new THREE.Points(geom, groundMaterial);\n  groundPoints.sortParticles = true;\n  groundPoints.sourceBounds = sourceBounds;\n  groundPoints.viewBounds = geom.boundingBox;\n  groundPoints.rotateX(Math.PI / -2);\n  return groundPoints;\n}\n\n\nfunction toShape(xyzArr, sourceBounds) {\n  const [numX, numY] = xyzArr.computeArrayShape();\n  //console.log(`numX:${numX} numY:${numY}`);\n  const geom2 = new THREE.PlaneBufferGeometry(numX, numY, numX - 1, numY - 1);\n  const position = geom2.getAttribute('position');\n  const vertices = position.array;\n  // TODO: there's probably methods in Geometry to do this.\n  xyzArr.transferXYZ(vertices);\n  geom2.center();\n  geom2.computeBoundingBox();\n  geom2.computeFaceNormals();\n  geom2.computeVertexNormals();\n  const obj = new THREE.Mesh(geom2, new THREE.MeshPhongMaterial({\n    color: 'green', side: THREE.DoubleSide, shininess: 10, wireframe: false\n  }));\n  obj.receiveShadow = true;\n  obj.sourceBounds = sourceBounds;\n  obj.viewBounds = geom2.boundingBox;\n  obj.rotateX(Math.PI / -2);\n  return obj;\n}\n\n\nfunction cutSection(xyz, xMin, xMax, yMin, yMax) {\n  if (xyz.length < 3) {\n    throw new Error('Empty data');\n  }\n  const out = [];\n  for (let i = 0; i < xyz.length; i+=3) {\n    const x = xyz[i];\n    const y = xyz[i + 1];\n    const z = xyz[i + 2];\n    if (x >= xMin && x <= xMax\n        && y >= yMin && y <= yMax) {\n      out.push(x, y, z);\n    }\n  }\n  return out;\n}\n","import * as THREE from 'three/build/three.module.js';\nimport {MapControls} from 'three/examples/jsm/controls/OrbitControls.js';\n\nimport Fullscreen from '@pablo-mayrgundter/fullscreen.js/fullscreen.js';\nimport XYZObject from './XYZObject.js';\n\n\nconst zoomBoxOpacity = 0.3;\n\n/**\n * Display XYZObject and active section selection.  Defaults to\n * binding DOM elt '#view'.\n */\nexport default class View extends THREE.Scene {\n  constructor(container = document.querySelector('#view'), animCb = null) {\n    super();\n    if (!container) {\n      throw new Error('View container not found');\n    }\n    this.container = container;\n    this.animCb = animCb;\n    this.width = container.innerWidth;\n    this.height = container.innerHeight;\n    this.camera = new THREE.PerspectiveCamera(45, this.width / this.height, 0.1, 1e10);\n    this.camera.position.set(0, 3e1, 1.5e2);\n    this.add(this.camera);\n    this.add(new THREE.AxesHelper);\n    const radius = 6357 * 1000; // (radius in meters; 1 gl unit = 1 meter)\n    const globe = new THREE.Mesh(\n      new THREE.SphereGeometry(radius, 120, 120 / 2),\n      new THREE.MeshPhongMaterial({\n        flatShading: false,\n        wireframe: true,\n        color: 0xaaffaa,\n      }));\n    const altitudeOffset = 1e1; // todo\n    globe.position.set(0, -radius - altitudeOffset, 0);\n    globe.rotateX(Math.PI / 2);\n    this.add(globe);\n    this.background = new THREE.Color(0xbfd1e5);\n    const light = new THREE.PointLight();\n    //this.add(new THREE.AmbientLight());\n    // TODO: better shadows.\n    // https://github.com/mrdoob/three.js/issues/8238\n    // https://github.com/mrdoob/three.js/pull/15670\n    light.castShadow = true;\n    light.intensity = zoomBoxOpacity;\n    light.shadow.camera.near = 0.5;\n    light.shadow.camera.far = 250;\n    light.shadow.camera.width = 256;\n    light.shadow.camera.height = 256;\n    light.position.set(-5e1, 1e6, -5e1);\n    this.add(light);\n    this.light = light;\n    const shadowLight = light.clone();\n    shadowLight.castShadow = false;\n    shadowLight.intensity = 1.0 - zoomBoxOpacity;\n    this.add(shadowLight);\n    this.renderer = new THREE.WebGLRenderer({antialias: true});\n    this.renderer.shadowMap.enabled = true;\n    //TODO: check about the mobile thing\n    //renderer.setPixelRatio(window.devicePixelRatio);\n    this.renderer.setSize(this.width, this.height);\n    container.appendChild(this.renderer.domElement);\n    this.controls = new MapControls(this.camera, this.renderer.domElement);\n    this.fs = new Fullscreen(container, () => {\n        this.onWindowResize();\n      });\n    this.onWindowResize();\n    window.addEventListener('resize', () => {\n        this.onWindowResize();\n      });\n    this.animate();\n    document.view = this;\n    this.zoomBox = null;\n  }\n\n\n  displayXYZObject(xyzObj) {\n    if (this.xyzObj) {\n      this.remove(this.xyzObj);\n    }\n    this.add(xyzObj);\n    this.xyzObj = xyzObj;\n    this.light.target = xyzObj;\n  }\n\n\n\n  /**\n   * @param zoomBoundsIn The active zoom in world coordinates (LV95).\n   */\n  focus(zoomBoundsIn) {\n    if (zoomBoundsIn == null) {\n      throw new Error('zoomBoundsIn null');\n    }\n    const zoomBounds = {\n      min: { x: zoomBoundsIn.Xmin, y: zoomBoundsIn.Ymin },\n      max: { x: zoomBoundsIn.Xmax, y: zoomBoundsIn.Ymax }\n    };\n    // Source bounds in world coordinates (LV95).\n    const sourceBounds = this.xyzObj.children[0].sourceBounds;\n    const sourceWidth = sourceBounds.max.x - sourceBounds.min.x;\n    const sourceDepth = sourceBounds.max.y - sourceBounds.min.y;\n    // View bounds in scaled scene coordinates (webgl units).\n    const viewBounds = this.xyzObj.children[0].viewBounds;\n    const viewWidth = viewBounds.max.x - viewBounds.min.x;\n    const viewDepth = viewBounds.max.y - viewBounds.min.y;\n    const viewXOff = viewBounds.min.x;\n    const viewYOff = viewBounds.min.y;\n    const zoomX = zoomBounds.min.x;\n    const zoomY = zoomBounds.min.y;\n    const zoomWidth = zoomBounds.max.x - zoomBounds.min.x;\n    const zoomDepth = zoomBounds.max.y - zoomBounds.min.y;\n    const ZOOM_EXTRA = 1;\n    const zoomHeight = viewBounds.max.z - viewBounds.min.z + ZOOM_EXTRA;\n    const boxX = zoomX - sourceBounds.min.x;\n    //console.log(`zoomX(${zoomX}) - sourceBounds.min.x(${sourceBounds.min.x})`);\n    const boxY = zoomY - sourceBounds.min.y;\n    const boxWidth = zoomWidth / sourceWidth * viewWidth;\n    const boxHeight = zoomHeight;\n    const boxDepth = zoomDepth / sourceDepth * viewDepth;\n    const geometry = new THREE.BoxGeometry(boxWidth, boxHeight, boxDepth);\n    geometry.center();\n    const material = new THREE.MeshBasicMaterial({\n        color: 0xffffff, transparent: true, opacity: zoomBoxOpacity});\n    const box = new THREE.Mesh(geometry, material);\n    box.castShadow = true;\n    box.receiveShadow = true;\n    const wireBox = box.clone();\n    wireBox.castShadow = false;\n    wireBox.receiveShadow = false;\n    wireBox.material = new THREE.MeshBasicMaterial({\n        color: 0xccccff, transparent: true, opacity: zoomBoxOpacity, wireframe: true});\n    box.add(wireBox);\n    if (this.zoomBox) {\n      this.remove(this.zoomBox);\n    }\n    this.add(this.zoomBox = box);\n    function b2s(name, b) {\n      return `${name}(min: x:${b.min.x} y:${b.min.y} z:${b.min.z} max: x:${b.max.x} y:${b.max.y} z:${b.max.z})`;\n    }\n    box.position.x = viewXOff + boxX + boxWidth - (boxWidth / 2);\n    // Note y swapped to z.\n    box.position.z = -viewYOff - boxY - boxDepth + (boxDepth / 2);\n    box.position.y -= (ZOOM_EXTRA / 2);\n    // console.log(`box(x: ${boxX} y:${boxY} w:${boxWidth} h:${boxHeight} d:${boxDepth})`);\n    // console.log(`box(x: ${boxX} y:${boxY} w:${boxWidth} h:${boxHeight} d:${boxDepth}) zoomX:${zoomX}`,\n    //            b2s('source', sourceBounds), b2s('view', viewBounds), b2s('zoom', zoomBounds),\n    //            box.position);\n  }\n\n\n  animate() {\n    this.controls.update();\n    this.renderer.render(this, this.camera);\n    if (this.animCb) {\n      this.animCb(this);\n    }\n    requestAnimationFrame(() => {\n        this.animate();\n      });\n  }\n\n\n  onWindowResize() {\n    if (this.fs.isFullscreen()) {\n      this.width = window.innerWidth;\n      this.height = window.innerHeight;\n    } else {\n      this.width = this.container.offsetWidth;\n      this.height = this.container.offsetHeight;\n    }\n    this.camera.aspect = this.width / this.height;\n    this.camera.updateProjectionMatrix();\n    this.renderer.setSize(this.width, this.height);\n  }\n}\n\n\n","import * as Vue from 'vue';\nimport * as Diurnal from '@pablo-mayrgundter/diurnal.js';\nimport Permalink from '../permalink.js';\nimport Fullscreen from '@pablo-mayrgundter/fullscreen.js';\nimport {XYZLoader} from 'three/examples/jsm/loaders/XYZLoader.js';\n\nimport App from './App.vue';\nimport FileLoaderControl from './FileLoaderControl.js';\nimport SelectionControl from './SelectionControl.js';\nimport View from './View.js';\nimport XYZObject from './XYZObject.js';\n\n// TODO get rid of this\nimport {lv952wgs, wgs2lv95, System} from '../coords/coords.js';\n\n// TODO(https://github.com/buildrs/xyz/issues/1): CSS loading is weird.\nimport css from '../../public/index.css';\n\n\nDiurnal.bind();\nnew Fullscreen(document.getElementById('view'));\n\nconsole.log('permalink in extract/index: ', Permalink);\n\nlet sc;\nconst view = new View();\nlet comp;\nconst app = Vue.createApp({\n  components: {\n    'extract-tool': App,\n  },\n  data() {\n    const d = {\n      coordinate: {\n        lat: Permalink.lat,\n        lon: Permalink.lon,\n        system: System.WGS84,\n        N: 0, //placeholder replaced during 'created' \n        E: 0, //placeholder replaced during 'created'\n      },\n      min: {\n        lat: Permalink.min_lat,\n        lon: Permalink.min_lon,\n        system: System.WGS84\n      },\n      max: {\n        lat: Permalink.max_lat,\n        lon: Permalink.max_lon,\n        system: System.WGS84\n      }\n    };\n    //console.log('extract/index.js#data:', d);\n    return d;\n  },\n  created() {\n    //console.log(`created: ${this.coordinate}`);\n    comp = this;\n    window.comp = comp;\n\n    // converts\n    const lv95center = wgs2lv95(Permalink.lat, Permalink.lon);\n    this.coordinate.N = lv95center[0];\n    this.coordinate.E = lv95center[1];\n  },\n  methods: {\n    setCoord(N, E, R) {\n      //console.log('extract/index.js#setCoord', this.coordinate, this.min, this.max);\n      /*\n      this.coordinate.N = N;\n      this.coordinate.E = E;\n      [this.coordinate.lat, this.coordinate.lon] = lv952wgs(N, E);\n      */\n      console.log('index.js#init', this.coordinate, this.min, this.max);\n      this.onCoordBounds({coordinate: this.coordinate, min: this.min, max: this.max});\n    },\n    onCoordBounds(event) {\n      const min = event.min, max = event.max;\n      const lv95min = wgs2lv95(min.lat, min.lon);\n      const lv95max = wgs2lv95(max.lat, max.lon);\n      //console.log(`coord-bounds-change: `, lv95min, lv95max);\n      const zoom = {\n        Xmin: lv95min[1],\n        Xmax: lv95max[1],\n        Ymin: lv95min[0],\n        Ymax: lv95max[0],\n      };\n      //console.log('extract/index.js:calling zoom: ', zoom);\n      view.focus(zoom);\n      sc.processBounds(zoom, document.getElementById('dlbtn'));\n    },\n  },\n  watch: {\n    coord: {\n      handler() {\n        console.log('extract/index.js#coord handler', this.coordinate);\n      },\n      deep: true\n    },\n  }\n});\napp.mount('#app');\n\n\nconst display = geometry => {\n  const obj = new XYZObject(geometry);\n  view.displayXYZObject(obj);\n  const bounds = obj.shape.sourceBounds;\n  if (comp) {\n    const centerPointCoordinates = comp.coordinate;\n    sc = new SelectionControl(obj, centerPointCoordinates, obj.shape.sourceBounds, obj.shape.viewBounds, zoom => {\n      //view.focus(zoom);\n    });\n    \n    const N = bounds.min.y + (bounds.max.y - bounds.min.y) / 2;\n    const E = bounds.min.x + (bounds.max.x - bounds.min.x) / 2;\n    //console.log(comp, bounds, N, E);\n    comp.setCoord(N, E, 1);\n  } else {\n    //console.error('comp not yet defined');\n  }\n};\n\n\nconst selectElt = document.querySelector(\"select[name='sources']\");\nselectElt.addEventListener('change', () => {\n  const trimmed = trimFileStart(selectElt.value);\n  new XYZLoader().load(trimmed, display);\n});\nconst trimmed = trimFileStart(selectElt.value);\nnew XYZLoader().load(trimmed, display);\n\nconst fileLoaderElt = document.getElementById('fileLoader');\nconst fileCtrl = new FileLoaderControl(fileLoaderElt, loadedXyz => {\n    const trimmed = trimFileStart(loadedXyz);\n    display(new XYZLoader().parse(trimmed));\n  });\n\nfunction trimFileStart(text){\n  // valid lines start with three integers or floats separated by whitespace\n  const validLineRegex = /(\\d+\\.?\\d*)\\s+(\\d+\\.?\\d*)\\s+(\\d+\\.?\\d*).*/g; \n  const indexOfFirstValidLine = text.search(validLineRegex);\n  const trimmed = text.substring(indexOfFirstValidLine);\n  console.log('trimmed',trimmed);\n  return trimmed;\n}\n\nfunction handleHash() {\n  let hash = location.hash.substr(1);\n}\nwindow.addEventListener('hashchange', handleHash);\nhandleHash();\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./App.vue?vue&type=style&index=0&id=78e27a06&scoped=true&lang=css\""],"sourceRoot":""}